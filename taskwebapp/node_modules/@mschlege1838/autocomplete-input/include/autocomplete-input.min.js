function OffsetCoordinates(t,e){"use strict";this.x=t,this.y=e}function AutocompleteInput(t,e,o){"use strict";var s;this.input=t,this.matcher=e,o&&(o.matchDelay&&(this.matchDelay=o.matchDelay),o.preventDefaultOnTab||(this.preventDefaultOnTab=o.preventDefaultOnTab),void 0!==o.ignoreCase&&(this.ignoreCase=o.ignoreCase),o.stopPropagationOnControl&&(this.stopPropagationOnControl=o.stopPropagationOnControl)),this.autocompleteElement=e=document.createElement("div"),e.className=AutocompleteInput.AUTO_COMPLETE_ELEMENT_CLASS,(o=document.createElement("ul")).className=AutocompleteInput.AUTO_COMPLETE_LIST_CLASS,e.appendChild(o),(s=this).onMatchesCallback=function(t){s.processMatches(t)}}OffsetCoordinates.getOffset=function(t){"use strict";var e=new OffsetCoordinates(t.offsetLeft,t.offsetTop);return OffsetCoordinates._getOffset(t.offsetParent,e),e},OffsetCoordinates._getOffset=function(t,e){"use strict";t&&(e.x+=t.offsetLeft,e.y+=t.offsetTop,OffsetCoordinates._getOffset(t.offsetParent,e))},AutocompleteInput.AUTO_COMPLETE_ELEMENT_CLASS="auto-complete-box",AutocompleteInput.AUTO_COMPLETE_LIST_CLASS="auto-complete-list",AutocompleteInput.MATCH_SUBSTRING_CLASS_NAME="auto-complete-substring",AutocompleteInput.MATCH_ITEM_CLASS_NAME="auto-complete-match-item",AutocompleteInput.AUTO_COMPLETE_BOX_ACTIVE_CLASS_NAME="auto-complete-active",AutocompleteInput.HIGHLIGHTED_CLASS_NAME="highlighted",AutocompleteInput.setMatchRange=function(t,e,o,s){"use strict";var n=(s?o.toLowerCase():o).indexOf(e);if(-1===n)return!0;for(;t.childNodes.length;)t.removeChild(t.childNodes[0]);s=n+e.length,t.appendChild(document.createTextNode(o.substring(0,n))),(e=document.createElement("span")).className=AutocompleteInput.MATCH_SUBSTRING_CLASS_NAME,e.appendChild(document.createTextNode(o.substring(n,s))),t.appendChild(e),t.appendChild(document.createTextNode(o.substring(s)))},AutocompleteInput.prototype.timeoutId=0,AutocompleteInput.prototype.matchDelay=100,AutocompleteInput.prototype.currentMatches=null,AutocompleteInput.prototype.preventDefaultOnTab=!0,AutocompleteInput.prototype.ignoreCase=!0,AutocompleteInput.prototype.stopPropagationOnControl=!0,AutocompleteInput.prototype.mouseOver=!1,AutocompleteInput.prototype.prevValue=null,AutocompleteInput.prototype.init=function(){"use strict";var t=this.input;this.input.addEventListener("keyup",this,!1),this.input.addEventListener("keydown",this,!1),this.input.addEventListener("blur",this,!1),t.setAttribute("autocomplete","off"),document.getElementsByTagName("body")[0].appendChild(this.autocompleteElement),this.autocompleteElement.addEventListener("mouseenter",this,!1),this.autocompleteElement.addEventListener("mouseleave",this,!1)},AutocompleteInput.prototype.dispose=function(){"use strict";var t,e;for(this.input.removeEventListener("keyup",this,!1),this.input.removeEventListener("keydown",this,!1),t=this.currentMatches,e=0;e<t.length;++e)t[e].removeEventListener("click",this,!1);this.currentMatches=null,this.autocompleteElement.removeEventListener("mouseenter",this,!1),this.autocompleteElement.removeEventListener("mouseleave",this,!1),document.getElementsByTagName("body")[0].removeChild(this.autocompleteElement),delete this.onMatchesCallback},AutocompleteInput.prototype.handleEvent=function(t){"use strict";var e,o,s,n,i=t.target;if(i===this.input)switch(t.type){case"keydown":if(!this.isOpen())return;if(e=t.key,o=t.keyCode,"ArrowDown"===e||40===o)return void this.moveSelection();if("ArrowUp"===e||38===o)return void this.moveSelection(!0);if((s="Tab"===e||9===o)||"Enter"===e||13===o)return s&&!this.preventDefaultOnTab||t.preventDefault(),this.stopPropagationOnControl&&t.stopImmediatePropagation(),void((n=this.autocompleteElement.getElementsByClassName(AutocompleteInput.HIGHLIGHTED_CLASS_NAME)[0])&&this.updateInput(n));break;case"keyup":e=t.key,o=t.keyCode,"ArrowDown"===e||40===o||"ArrowUp"===e||38===o||"Tab"===e||9===o||s||"Enter"===e||13===o||this.initMatch();break;case"blur":this.mouseOver||this.closeBox()}else if(i===this.autocompleteElement)switch(t.type){case"mouseenter":this.mouseOver=!0;break;case"mouseleave":this.mouseOver=!1}else if(i.classList.contains(AutocompleteInput.MATCH_ITEM_CLASS_NAME))switch(t.type){case"click":this.updateInput(i);break;case"mouseenter":this.scrollOver(i)}},AutocompleteInput.prototype.initMatch=function(){"use strict";var t=this,e=this.timeoutId;if(e&&clearTimeout(e),!this.input.value)return this.prevValue=null,void this.closeBox();this.timeoutId=setTimeout(function(){t.fetchMatch()},this.matchDelay)},AutocompleteInput.prototype.fetchMatch=function(){"use strict";var t,e,o=this.input.value;if(!o)return this.prevValue=null,void this.closeBox();o!==this.prevValue&&(t=this.matcher,e=this.onMatchesCallback,"function"==typeof t.fetchMatches?t.fetchMatches(o,e):t(o,e),this.prevValue=o)},AutocompleteInput.prototype.processMatches=function(t){"use strict";var e,o,s,n,i,u,p,l,a,c,r,m;if(t&&t.length){for(o=(e=this.autocompleteElement).getElementsByClassName(AutocompleteInput.AUTO_COMPLETE_LIST_CLASS)[0],u=this.input,r=this.ignoreCase,p=u.value,m=r?p.toLowerCase():p,n=o.querySelectorAll("[data-match-word]"),s=0;s<n.length;++s)a=n[s],-1===(i=t.indexOf(a.getAttribute("data-match-word")))?this.removeMatch(a):(AutocompleteInput.setMatchRange(a,m,t[i],r)&&this.removeMatch(a),t.splice(i,1));for(s=0;s<t.length;++s)l=t[s],a=document.createElement("li"),AutocompleteInput.setMatchRange(a,m,l,r)||(a.setAttribute("data-match-word",l),a.className=AutocompleteInput.MATCH_ITEM_CLASS_NAME,a.addEventListener("click",this,!1),a.addEventListener("mouseenter",this,!1),o.appendChild(a));o.getElementsByClassName(AutocompleteInput.MATCH_ITEM_CLASS_NAME).length?(c=OffsetCoordinates.getOffset(u),e.style.left=c.x+"px",e.style.top=c.y+u.offsetHeight+"px",e.style.minWidth=u.offsetWidth+"px",e.classList.add(AutocompleteInput.AUTO_COMPLETE_BOX_ACTIVE_CLASS_NAME),o.getElementsByClassName(AutocompleteInput.HIGHLIGHTED_CLASS_NAME).length||this.moveSelection()):console.warn("No matching items for current value: "+p)}else this.closeBox()},AutocompleteInput.prototype.moveSelection=function(t){"use strict";for(var e,o=this.autocompleteElement.getElementsByClassName(AutocompleteInput.MATCH_ITEM_CLASS_NAME),s=t?o.length:-1,n=0;n<o.length;++n)if((e=o[n]).classList.contains(AutocompleteInput.HIGHLIGHTED_CLASS_NAME)){e.classList.remove(AutocompleteInput.HIGHLIGHTED_CLASS_NAME),s=n;break}t?--s:s+=1,s<0?s=o.length-1:s>=o.length&&(s=0),o[s].classList.add(AutocompleteInput.HIGHLIGHTED_CLASS_NAME)},AutocompleteInput.prototype.scrollOver=function(t){"use strict";for(var e,o=this.autocompleteElement.getElementsByClassName(AutocompleteInput.MATCH_ITEM_CLASS_NAME),s=0;s<o.length;++s)(e=o[s])===t?e.classList.add(AutocompleteInput.HIGHLIGHTED_CLASS_NAME):e.classList.remove(AutocompleteInput.HIGHLIGHTED_CLASS_NAME)},AutocompleteInput.prototype.closeBox=function(){"use strict";this.autocompleteElement.classList.remove(AutocompleteInput.AUTO_COMPLETE_BOX_ACTIVE_CLASS_NAME)},AutocompleteInput.prototype.isOpen=function(){"use strict";return this.autocompleteElement.classList.contains(AutocompleteInput.AUTO_COMPLETE_BOX_ACTIVE_CLASS_NAME)},AutocompleteInput.prototype.updateInput=function(t){"use strict";this.input.value=t.textContent,this.closeBox()},AutocompleteInput.prototype.removeMatch=function(t){"use strict";t.removeEventListener("click",this,!1),t.removeEventListener("mouseenter",this,!1),t.parentNode.removeChild(t)};